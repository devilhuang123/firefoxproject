<!DOCTYPE html>
<html>
<head>
	<title>Facebook Post</title>
	<meta charset="UTF-8">
	<link rel="stylesheet" href="./css/buttons.css">
</head>
<body>
<div id="fb-root"></div>
<script>
  window.fbAsyncInit = function() {
    // init the FB JS SDK
    FB.init({
      appId      : '534601883297900',                        // App ID from the app dashboard
      status     : true,                                 // Check Facebook Login status
      xfbml      : true                                  // Look for social plugins on the page
    });

    // Additional initialization code such as adding Event Listeners goes here
    
  // Here we subscribe to the auth.authResponseChange JavaScript event. This event is fired
  // for any authentication related change, such as login, logout or session refresh. This means that
  // whenever someone who was previously logged out tries to log in again, the correct case below 
  // will be handled. 
  FB.Event.subscribe('auth.authResponseChange', function(response) {
    // Here we specify what we do with the response anytime this event occurs. 
    if (response.status === 'connected') {
      // The response object is returned with a status field that lets the app know the current
      // login status of the person. In this case, we're handling the situation where they 
      // have logged in to the app.
      	FB.api('/me', function(response) {
			alert('Post Name\n'+ response.name);
    	});
      	init();
      	//do_post();
    } else if (response.status === 'not_authorized') {
      // In this case, the person is logged into Facebook, but not into the app, so we call
      // FB.login() to prompt them to do so. 
      // In real-life usage, you wouldn't want to immediately prompt someone to login 
      // like this, for two reasons:
      // (1) JavaScript created popup windows are blocked by most browsers unless they 
      // result from direct interaction from people using the app (such as a mouse click)
      // (2) it is a bad experience to be continually prompted to login upon page load.
      //document.location.href="https://m.facebook.com/dialog/oauth/?client_id=534601883297900&redirect_uri=http://web.cc.ncu.edu.tw/~102522071/fb.html";
      //login();
    } else {
      // In this case, the person is not logged into Facebook, so we call the login() 
      // function to prompt them to do so. Note that at this stage there is no indication
      // of whether they are logged into the app. If they aren't then they'll see the Login
      // dialog right after they log in to Facebook. 
      // The same caveats as above apply to the FB.login() call here.
     document.location.href="https://m.facebook.com/dialog/oauth/?client_id=534601883297900&redirect_uri=http://web.cc.ncu.edu.tw/~102522071/fb.html";
      //FB.login();
    }
  });
  
  
  
  };

  // Load the SDK asynchronously
  (function(){
     // If we've already installed the SDK, we're done
     if (document.getElementById('facebook-jssdk')) {return;}

     // Get the first script element, which we'll use to find the parent node
     var firstScriptElement = document.getElementsByTagName('script')[0];

     // Create a new script element and set its id
     var facebookJS = document.createElement('script'); 
     facebookJS.id = 'facebook-jssdk';

     // Set the new script's source to the source of the Facebook JS SDK
     facebookJS.src = '//connect.facebook.net/en_US/all.js';

     // Insert the Facebook JS SDK into the DOM
     firstScriptElement.parentNode.insertBefore(facebookJS, firstScriptElement);
   }());

/*function login() {
    FB.login(function(response) {
        if (response.authResponse) {
            init();
        }
    }, {scope: 'publish_actions,publish_stream'});
}*/
	
   
</script>




<script>
	var body = ['Test',
				'Test2',
				'Test3',
				'Test4',
				'Test5'];
	var count = 0;
function do_post()
{
	
        /*var attachment = {
                'name':'Quiz',
                'href':'http://apps.facebook.com/your_apps/',
                'description':'good!',
                'caption':'{*actor*} is very smart!',
                'comments_xid':'1',
                'media':[
                                {
                                        'type':'image',
                                        'src':'http://upload.wikimedia.org/wikipedia/commons/thumb/0/06/Facebook.svg/200px-Facebook.svg.png',
                                        'href':'http://zh.wikipedia.org/wiki/Facebook'
                                }
                ]
        };*/
        //Facebook.streamPublish( ''  , attachment , null , null , 'Message:' , null , false  );
//        FB.Connect.streamPublish( '' , attachment , null , null , 'Message:' , null , false  );
	/*
	FB.login(function(response) {
   		// handle the response
   		if (response.authResponse) {
     			var body = ['ABC' , 'DEF','測試'];
	
				FB.api('/me/feed', 'post', { message: body[2] }, function(response) {
				  if (!response || response.error) {
				    alert('Error occured');
				  } else {
				  	//alert('Post Name' + response.name);
				  }
				});		

   		} else {
     		//console.log('User cancelled login or did not fully authorize.');
   		}
 	}, {scope: 'publish_actions,publish_stream'});*/
	
	/*FB.api('/me', function(response) {
		document.write('Post name'+ response.name);
      	alert('Post Name\n'+ response.name);
    });*/

/*function login() {
    FB.login(function(response) {
        if (response.authResponse) {
            init();
        }
    }, {scope: 'publish_actions,publish_stream'});
}
	login();*/
	FB.api('/me/feed', 'post', { message: body[count%5] }, function(response) {
	  if (!response || response.error) {
	    alert('Error occured');
	  } else {
	  	//alert('Post Name' + response.name);
	  }
	});		
	count++;

}



</script>
<a role="button" href="" onclick="do_post();return false;">我失敗了</a>


</body>
</html>
